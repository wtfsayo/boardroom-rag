# RAG API Pipeline Architecture Overview

## Introduction

This document provides an overview of the RAG (Retrieval-Augmented Generation) API Pipeline architecture. The system is designed to extract, process, and store data from the Boardroom Governance API, creating a knowledge base that can be queried using natural language processing techniques.


## Diagram
![image](https://res.cloudinary.com/dwx9alovg/image/upload/v1725856208/rag-pipeline/toms0dzpmfbrmuw87xmd.png)

```mermaid
graph TB
    subgraph Airbyte["Airbyte + Pathway"]
        PM[Pipeline Manifest] -->|1.1 read| AL[APILoader]
        OS[OpenAPI Spec] -->|1.2 read| AL
        AL -->|2. generate| SM[Source manifest]
        SM -->|3. start| RAG[RAG Pipeline]
        RAG -->|3.5 store| KB[Knowledge Base]
        KB -->|5.3 store| RAG
    end

    subgraph RAGServer["RAG API Server"]
        LLM[LLM model]
        EM[Embedding model]
        OAI[OpenAI API]
    end

    BG[Boardroom Governance API] -->|4. extract| Airbyte
    RAG -->|5.4 feature embedding| RAGServer
    KB -->|6. Snapshot| RAGServer
    RAGServer <--> OAI

    GN[GaiaNet Protocol Network]
    RAGServer <--> GN

    HF[Hugging Face] -.->|Load| RAGServer

    subgraph Legend
        L1[Process]
        L2[Data Store]
        L3[External Service]
    end
```

## Components

### 1. Pipeline Manifest

- A YAML file that defines the configuration settings and API endpoints for extraction.
- Read at the start of the pipeline process (step 1.1).

### 2. OpenAPI Spec

- A YAML file containing the OpenAPI specification for the Boardroom Governance API.
- Read by the APILoader component (step 1.2).

### 3. APILoader

- Reads the Pipeline Manifest and OpenAPI Spec.
- Generates a Source Manifest (step 2) based on the input configurations.

### 4. Source Manifest

- A YAML file generated by the APILoader.
- Contains detailed information about the data sources and extraction parameters.

### 5. Boardroom Governance API

- The primary data source for the pipeline.
- Data is extracted from this API (step 4).

### 6. Airbyte + Pathway

- Airbyte is used for data extraction and initial processing.
- Pathway is used for data transformation and pipelining.
- These components work together to process the extracted data (step 5).

### 7. RAG Pipeline

- Consists of several sub-steps:
  - Preprocessing
  - Normalization
  - Semantic chunking
  - Feature embeddings
- Processes the data extracted by Airbyte (step 5).

### 8. Qdrant Vector Store

- A vector database used to store the processed and embedded data.
- Data is stored here after processing (step 5.5).

### 9. RAG API Server

- Hosts the following components:
  - LLM (Language Model)
  - Embedding model
  - OpenAI API integration
- Interfaces with the Qdrant Vector Store to retrieve relevant information.
- Connects to the GaiaNet Protocol Network.

### 10. OpenAI API

- Used by the RAG API Server for advanced natural language processing tasks.

### 11. GaiaNet Protocol Network

- The broader network that the RAG API Server interfaces with.
- Consists of multiple Gaia Nodes.

## Process Flow

1. The pipeline starts by reading the Pipeline Manifest (1.1) and OpenAPI Spec (1.2).
2. The APILoader generates a Source Manifest based on these inputs.
3. The pipeline begins data extraction from the Boardroom Governance API.
4. Extracted data is processed through the Airbyte + Pathway components.
5. The RAG Pipeline performs preprocessing, normalization, semantic chunking, and feature embedding.
6. Processed data is stored in the Qdrant Vector Store.
7. The RAG API Server can now access this data to respond to queries.
8. The RAG API Server may use the OpenAI API for additional processing or generation tasks.
9. The RAG API Server interfaces with the GaiaNet Protocol Network to provide its services.

## Using Pre-generated snapshots and models
 - You can also use models and snapshots supported by Gaianet node by defining them in the Gaianet node config file.
 - Check out the [Gaianet docs](http://docs.gaianet.ai) for more information.
